<!DOCTYPE html>

<html style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; font-size: 10px; -webkit-tap-highlight-color: rgba(0, 0, 0, 0)">
<body style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 0; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 13px; line-height: 1.428571; color: #000; background-color: #fff; position: absolute; left: 0; right: 0; top: 0; bottom: 0; overflow: visible; padding: 8px'>
<div class="border-box-sizing" id="notebook" style='font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 14px; line-height: 20px; overflow-y: hidden; overflow-x: auto; width: 100%; padding-top: 0; margin: 0; outline: none; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; min-height: 100%; overflow: visible; border-top: none' tabindex="-1">
<div class="container" id="notebook-container" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-right: auto; margin-left: auto; padding-left: 0; padding-right: 0">
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">In this post, I would like to share the steps to build a fun project implementing a console-based progress-spinner that runs in a separate thread while executing arbitrary code in the main thread. The code I'm sharing is compatible with WindowsPowerShell 5.1 and works best when executed within Windows Terminal rather than the PowerShell console window. To keep the cursor in the same position, while writing the progress, we will make use of <a href="https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">ANSI-Escape sequences</a>.</p>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Let's start with a very simple example just to show how it works.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">simpleSpinner</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$([char]27)"</span>
    <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">10</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Begin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Process</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> 
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[u$_"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewLine</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Start-Sleep</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-MilliSeconds</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">100</span> 
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><img alt="simpleSpinner.gif" src="https://powershellone.files.wordpress.com/2021/03/img0.gif" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 0; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">The variable<code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">$e</code> in the example above holds the escape sequence that precedes any ANSI-Escape sequence (PowerShell 7 introduced the <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">e`</code> character sequence for that purpose see <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_special_characters?view=powershell-7.1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">here</a>. The two escape sequences used do the following:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<table style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border-spacing: 0; background-color: transparent; margin-left: auto; margin-right: auto; border: 1px solid black; border-collapse: collapse">
<thead style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"><tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<th style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px; font-weight: bold">Sequence</th>
<th style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px; font-weight: bold">Description</th>
</tr>
</thead>
<tbody style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">
<tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">$e[s</td>
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">Save the current cursor position</td>
</tr>
<tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">$e[u</td>
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">Restore the saved cursor position.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">With the basic logic out of the way, we need to figure out the spinner design. Luckily, the <a href="https://github.com/sindresorhus/cli-spinners" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">cli-spinners project on GitHub</a> includes a JSON file with a collection of terminal spinner icons that can be used to show an animation during a longer running process. 
Let's write a PowerShell function that makes use of those for a light-weight Write-Progress version.</p>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">First, we need to download the JSON file and convert it to a PowerShell object and check what we got (the output is only showing the first few entries to save space)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">url</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'https://raw.githubusercontent.com/sindresorhus/cli-spinners/main/spinners.json'</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">json</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Invoke-WebRequest</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Uri</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">url</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Content</span> 
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">json</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">ConvertFrom-Json</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; position: relative; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; z-index: 1">
<div class="output" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch">
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_subarea output_stream output_stdout output_text" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex); text-align: left; color: #000; line-height: 1.21429em">
<pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; font-size: inherit; line-height: inherit; white-space: pre; margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0">
aesthetic : @{interval=80; frames=System.Object[]}
arc       : @{interval=100; frames=System.Object[]}
arrow     : @{interval=100; frames=System.Object[]}
arrow2    : @{interval=80; frames=System.Object[]}
arrow3    : @{interval=120; frames=System.Object[]}


</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Ok, what we got is one PSCustomObject with one property per spinner icon set.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">bouncingBall</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frames</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; position: relative; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; z-index: 1">
<div class="output" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch">
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_subarea output_stream output_stdout output_text" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex); text-align: left; color: #000; line-height: 1.21429em">
<pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; font-size: inherit; line-height: inherit; white-space: pre; margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0">( �    )
(  �   )
(   �  )
(    � )
(     �)
(    � )
(   �  )
(  �   )
( �    )
(�     )
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">In order to pick from the spinner icon sets, I'd like to have a parameter that'll provide me with all the possible icon set names. We can use <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">Get-Member</code> and <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">ValidateSet</code> to do this.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Member</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-MemberType</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">NoteProperty</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Name</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span><span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"'$_'"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-join</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">','</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">clip</span>
<span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#pasted the copied names below</span>
<span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-TerminalProgress</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">CmdletBinding</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()]</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Param</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">ValidateSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'aesthetic'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arc'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'balloon'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'balloon2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'betaWave'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bluePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bounce'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bouncingBall'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bouncingBar'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'boxBounce'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'boxBounce2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'christmas'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circleHalves'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circleQuarters'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'clock'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots10'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots11'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots12'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots4'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots5'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots6'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots7'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots8'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots8Bit'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots9'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dqpb'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'earth'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'fingerDance'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'fistBump'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'flip'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'grenade'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'growHorizontal'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'growVertical'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'hamburger'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'hearts'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'layer'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'line'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'line2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'material'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'mindblown'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'monkey'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'moon'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'noise'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'orangeBluePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'orangePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'pipe'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'point'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'pong'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'runner'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'shark'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'simpleDots'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'simpleDotsScrolling'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'smiley'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'soccerHeader'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'speaker'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'squareCorners'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'squish'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'star'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'star2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'timeTravel'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle10'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle11'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle12'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle13'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle4'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle5'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle6'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle7'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle8'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle9'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'triangle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'weather'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Now let's add the logic to display the spinner icons with the help of the ANSI-Escape sequences. I have saved the JSON file locally in order to avoid downloading it every time I run the function.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Invoke-WebRequest</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Uri</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">url</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Content</span>  <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> 
    <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Set-Content</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Path</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">env</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">USERPROFILE</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">\</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Desktop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">\</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">json</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Encoding</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">UTF8</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-TerminalProgress</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">CmdletBinding</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()]</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Param</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Parameter</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Mandatory</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">ValidateSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'aesthetic'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arc'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'balloon'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'balloon2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'betaWave'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bluePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bounce'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bouncingBall'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bouncingBar'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'boxBounce'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'boxBounce2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'christmas'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circleHalves'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circleQuarters'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'clock'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots10'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots11'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots12'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots4'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots5'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots6'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots7'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots8'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots8Bit'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots9'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dqpb'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'earth'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'fingerDance'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'fistBump'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'flip'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'grenade'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'growHorizontal'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'growVertical'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'hamburger'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'hearts'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'layer'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'line'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'line2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'material'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'mindblown'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'monkey'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'moon'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'noise'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'orangeBluePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'orangePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'pipe'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'point'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'pong'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'runner'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'shark'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'simpleDots'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'simpleDotsScrolling'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'smiley'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'soccerHeader'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'speaker'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'squareCorners'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'squish'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'star'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'star2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'timeTravel'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle10'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle11'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle12'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle13'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle4'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle5'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle6'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle7'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle8'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle9'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'triangle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'weather'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">path</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$env:USERPROFILE\Desktop\spinners.json"</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Content</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">path</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">ConvertFrom-Json</span> 
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameCount</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frames</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">count</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameLength</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frames</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">].</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Length</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameInterval</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">interval</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$([char]27)"</span>
    <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">30</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Begin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">write-host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$($e)[s"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Process</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> 
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frame</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frames</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">%</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameCount</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[u$frame"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Start-Sleep</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Milliseconds</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameInterval</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[u$($e)[$($frameLength)PDone."</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Let's give this version a spin (no pun intended) before we look into the details.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-TerminalProgress</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-IconSet</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">soccerHeader</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><img alt="soccerSpinner.gif" src="https://powershellone.files.wordpress.com/2021/03/img1.gif" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 0; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Nice! Let's look at the additions and think about what else we want to add to turn this into a re-usable function.</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Based on the selected IconSet the following information is retrieved:<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 0; padding-left: 0; list-style: circle; margin: 0 2em">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">The number of frames within the IconSet (frameCount).</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">The length of the frame(s) (frameLength).</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">The interval at which we need to switch the frames.</li>
</ul>
</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Within the <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">Process</code> block of the <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">Foreach-Object</code> cmdlet we retrieve the frame based on the modulo operation.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">During each iteration, the frame is written to the console after which the process is paused based on the interval.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">After the loop finished we overwrite the Iconset using the two sequences:<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 0; padding-left: 0; list-style: circle; margin: 0 2em">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"><code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">$e[u</code> to restore the cursor position.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"><code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">$e[$($frameLength)PDone."</code> to delete the last iconset and write the text <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">Done.</code>. <ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 0; padding-left: 0; list-style: circle; margin: 0 2em">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"><code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">$e[&lt;NUMCHARSTODELETE&gt;P</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Those are the additional requirements for the next iteration of <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">Write-TerminalProgress</code>:</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Ability to provide InputObject(s) argument to iterate over via Pipeline.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Ability to provide script block arguments for the logic to be executed (similar to Foreach-Object's Begin|Process|End parameters.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Ability to Provide custom Activity (name for the overall process) and CurrentStatus (message displayed for each iteration) texts</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">For the ability to execute a script while showing progress at the same time we will need a separate thread (using <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">Start-ThreadJob</code> from the <a href="https://github.com/PaulHigin/PSThreadJob" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">PSThreadJob module</a>) that writes the progress to the console while the Process script block is running and potentially also emits some output to the console within the main thread. In order for the progress output not to interfere with the "normal" output, I put the progress output at the top left hand corner of the console window. We also need to add some additional ANSI-escape sequence and <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">[System.Console]</code> methods to control the display. You can read about the difference between the console buffer and the viewport/window <a href="https://docs.microsoft.com/en-us/windows/console/scrolling-the-screen-buffer" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">here</a>.</p>
<table style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border-spacing: 0; background-color: transparent; margin-left: auto; margin-right: auto; border: 1px solid black; border-collapse: collapse">
<thead style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"><tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<th style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px; font-weight: bold">Sequence</th>
<th style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px; font-weight: bold">Description</th>
</tr>
</thead>
<tbody style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">
<tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">\<del style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e[s\</del>(\<del style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e)[4;r\</del>(\$e)[u</td>
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">Define scrolling region. This sequence can take two parameters separated by semicolon the top row (defaults to 1) and left column of the scrolling region (defaults to the window height. In addition the  cursor position is saved and restored to its original position.</td>
</tr>
<tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">\$e[2J;[console]::SetCursorPosition(0,[console]::WindowTop+6)</td>
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">This is similar to clear screen, but does not delete the screen buffer. It moves the used buffer up to clear the wimdpw. The SetCursorPosition moves the cursor to the top of the viewport - 6 rows.</td>
</tr>
<tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">[console]::MoveBufferArea(0,[ console]::WindowTop,[console]::WindowWidth, [console]::WindowTop,0,[console]::WindowTop+5)</td>
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">Clears the top 5 rows of the viewport by moving the buffer down 5 rows  within the current window.</td>
</tr>
<tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">\$e[?25l</td>
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">Hide the cursor to avoid flickering during updates.</td>
</tr>
<tr style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em">
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">\$e[?25h</td>
<td style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid black; border-collapse: collapse; margin: 1em 2em; text-align: left; vertical-align: middle; padding: 4px">Show the cursor.</td>
</tr>
</tbody>
</table>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Since this is not trivial, I put together a proof of concept to test this functionality. I've added comments to try to illustrate how the different pieces fit together.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">testing</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">CmdletBinding</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()]</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Param</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Parameter</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Mandatory</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">ValueFromPipeline</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">InputObject</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Parameter</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Mandatory</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[ScriptBlock]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Process</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[switch]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ReturnFullOutput</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">BEGIN</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$([char]27)"</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#clear screen w/o buffer</span>
        <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[2J"</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#move cursor down by 6</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">SetCursorPosition</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">6</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#move everything down 5 lines to make space</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">MoveBufferArea</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowWidth</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">5</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> 
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#hide the cursor</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[?25l"</span>  <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>  
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#array list to collect output</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">output</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[System.Collections.ArrayList]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">new</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#create a thread safe object to be able to...</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#...communicate across threads</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">currentObject</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[System.Collections.Concurrent.ConcurrentDictionary[string,object]]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">new</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#define scrolling region making the top 3 rows a no scrolling area</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#see https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s$($e)[4;r$($e)[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#start the thread that show the progress</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">job</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Start-ThreadJob</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$([char]27)"</span>
            <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#run this in an infinite loop until the actual job is done</span>
            <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">while</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">true</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#retrieve the currently processed ...</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#...pipeline variable from the main thread</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">current</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">currentObject</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#safe the current cursor position</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#place the cursor at the top left position with some margin</span>
                <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">SetCursorPosition</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowWidth</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">20</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
                <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Write</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$($e)[$(20)P$(($i++)):$($current.curr)"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#restore the cursor position</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">sleep </span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Milliseconds</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">100</span> 
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-StreamingHost</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">host</span> 
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#process the actual Process scriptblock using foreach object</span>
    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#to be able to refer to $_ inside the script block</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">PROCESS</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
       <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Null</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">currentObject</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'curr'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">InputObject</span>
       <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">null</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">output</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Add</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">InputObject</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Process</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Process</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">))</span>
       <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">output</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[-</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span>

    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>

    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">END</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#clean up the job</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">job</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Stop-job</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-PassThru</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Remove-Job</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#remove the progress message</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Write</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">SetCursorPosition</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowWidth</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">20</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Write</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[20P"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Write</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[u"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#restore scrolling region</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s$($e)[r$($e)[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#show the cursor</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[?25h"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>  
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ReturnFullOutput</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">output</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">We can execute the test function with some dummy operation simulating processing. Let's simulate two runs with longer output to demonstrate the scrolling behaviour and the preservation of the screen buffer. The output that is scrolled due to the no-scrolling region is partially cut-off. Therefore. I've added a parameter to the funciton to optionally return the full output, too (<code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">ReturnFullOutput</code>).</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">margin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowWidth</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">/</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">text</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Length</span>
<span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'#'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">*</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">margin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'first iteration'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'#'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">*</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">margin</span>
<span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">5</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">testing</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Process</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span><span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"Processing item $_"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">10</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">sleep </span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-seconds</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'#'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">*</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">margin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'second iteration'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'#'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">*</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">margin</span>
<span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">5</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">testing</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Process</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span><span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"Processing item $_"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">10</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">sleep </span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-seconds</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><img alt="testing_.gif" src="https://powershellone.files.wordpress.com/2021/03/img2.gif" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 0; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">We now only need to add the remainder of the requirements to finish <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">Write-TerminalProgress</code>. Other than the additional logic, I have only made use of one additional escape sequence for positioning the cursor instead of using <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">[Sytsem.Console]::SetCursorPosition</code>: <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">$e[&lt;y&gt;;&lt;x&gt;H</code>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-TerminalProcess</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">CmdletBinding</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()]</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Param</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Parameter</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Mandatory</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">ValueFromPipeline</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">InputObject</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Parameter</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Mandatory</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">ValidateSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'aesthetic'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arc'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'arrow3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'balloon'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'balloon2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'betaWave'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bluePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bounce'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bouncingBall'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'bouncingBar'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'boxBounce'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'boxBounce2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'christmas'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circleHalves'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circleQuarters'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'clock'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots10'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots11'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots12'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots4'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots5'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots6'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots7'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots8'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots8Bit'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dots9'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dqpb'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'earth'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'fingerDance'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'fistBump'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'flip'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'grenade'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'growHorizontal'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'growVertical'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'hamburger'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'hearts'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'layer'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'line'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'line2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'material'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'mindblown'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'monkey'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'moon'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'noise'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'orangeBluePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'orangePulse'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'pipe'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'point'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'pong'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'runner'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'shark'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'simpleDots'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'simpleDotsScrolling'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'smiley'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'soccerHeader'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'speaker'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'squareCorners'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'squish'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'star'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'star2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'timeTravel'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle10'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle11'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle12'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle13'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle2'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle3'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle4'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle5'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle6'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle7'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle8'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'toggle9'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'triangle'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'weather'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[ScriptBlock]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Begin</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Parameter</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Mandatory</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[ScriptBlock]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Process</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[ScriptBlock]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">End</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[String]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Activity</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[String]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">CurrentStatus</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[switch]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ReturnFullOutput</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">BEGIN</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$([char]27)"</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#clear screen w/o buffer</span>
        <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$([char]0x1b)[2J"</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#move cursor down by 6</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">SetCursorPosition</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">6</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#move everything down 5 lines to make space</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">MoveBufferArea</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowWidth</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">5</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> 
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#hide the cursor</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[?25l"</span>  <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>  
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#array list to collect output</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">output</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[System.Collections.ArrayList]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">new</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#create a thread safe object to be able to...</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#...communicate across threads</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">currentObject</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[System.Collections.Concurrent.ConcurrentDictionary[string,object]]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">new</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#initialize variables</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">progressCounter</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$([char]27)"</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">path</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$PSScriptRoot\spinners.json"</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Content</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">path</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">ConvertFrom-Json</span> 
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameCount</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frames</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Count</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameLength</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frames</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">].</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Length</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rightMargin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameLength</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Activity</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Length</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-gt</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rightMargin</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rightMargin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Activity</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Length</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameInterval</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">interval</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#define scrolling region making the top 5 rows a no scrolling area</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#see https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s$($e)[5;r$($e)[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#start the thread that show the progress</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">job</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Start-ThreadJob</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">e</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$([char]27)"</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">iconSet</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rightMargin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rightMargin</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameCount</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameCount</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameInterval</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameInterval</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameLength</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameLength</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">currentStatus</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">CurrentStatus</span>
            <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#activity message</span>
            <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#safe the current cursor position</span>
            <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
            <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">SetCursorPosition</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowWidth</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rightMargin</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">4</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowTop</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
            <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Activity</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
            <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
            <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#run this in an infinite loop until the actual job is done</span>
            <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">while</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">true</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#retrieve the currently processed ...</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#...pipeline variable from the main thread</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">current</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">currentObject</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#write the status message</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">msg</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">currentStatus</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Replace</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'_'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">current</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">curr</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">xPos</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[console]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">WindowWidth</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rightMargin</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">4</span> 
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[$([console]::WindowTop+3);$($xPos)H$($e)[1M"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$($e)[$($currentStatus.Length+$current.Length)P$msg"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#place the cursor at the top left position with some margin and delete current line</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frame</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">spinners</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frames</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">progressCounter</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">%</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameCount</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[$([console]::WindowTop+4);$($xPos)H$($e)[1M"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#write the frame</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#Write-Host "$($e)[$($frameLength)P$frame" -NoNewline</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[$([console]::WindowTop+4);$($xPos)H$frame"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Start-Sleep</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Milliseconds</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">frameInterval</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">progressCounter</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">++</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-StreamingHost</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">host</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#process the actual Process scriptblock using foreach object</span>
    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#to be able to refer to $_ inside the script block</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">PROCESS</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
       <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">currentObject</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'curr'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">InputObject</span>
       <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">InputObject</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Process</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Process</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>

    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">END</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#clean up the job</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">job</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Stop-job</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-PassThru</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Remove-Job</span>        
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#restore scrolling region</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[s$($e)[r$($e)[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#delete the progress and activity message</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[$([console]::WindowTop+2);$([console]::WindowWidth-$rightMargin-4)H"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[5M$($e)[u"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#show the cursor</span>
        <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-Host</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"$e[?25h"</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span>  
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">End</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">End</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Invoke</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ReturnFullOutput</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">output</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">For a fun project, I've spent already way more time on this than I would have initially anticipated (because it actually was fun). Hopefully, someone will find this useful or even improve on this concept. The function, including full comment-based help, can be downloaded from my <a href="https://github.com/DBremen/Write-TerminalProgress" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">GitHub repo</a></p>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Let's give it a last spin. The CurrentStatus parameter automatically replaces '_' with the currently processed item.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">htArgs</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@{</span>
    <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IconSet</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'fistBump'</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Process</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"Doing $_"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">sleep </span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Seconds</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Activity</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'Working hard'</span>
    <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">CurrentStatus</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'Status _'</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">5</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Write-TerminalProgress</span> <span class="nv" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #19177C">@htArgs</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><img alt="final.gif" src="https://powershellone.files.wordpress.com/2021/03/img3.gif" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 0; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto"></p>
</div>
</div>
</div>
</div>
</div>
<p align="center" style="font-size: 12px; color: #9d9999;">Wordpress conversion from consoleFun.ipynb by <a href="https://github.com/bennylp/nb2wp">nb2wp</a> v0.3.1</p>
</body>
</html>
