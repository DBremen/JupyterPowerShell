<!DOCTYPE html>

<html style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: sans-serif; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%; font-size: 10px; -webkit-tap-highlight-color: rgba(0, 0, 0, 0)">
<body style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 0; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 13px; line-height: 1.428571; color: #000; background-color: #fff; position: absolute; left: 0; right: 0; top: 0; bottom: 0; overflow: visible; padding: 8px'>
<div class="border-box-sizing" id="notebook" style='font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; font-size: 14px; line-height: 20px; overflow-y: hidden; overflow-x: auto; width: 100%; padding-top: 0; margin: 0; outline: none; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; min-height: 100%; overflow: visible; border-top: none' tabindex="-1">
<div class="container" id="notebook-container" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-right: auto; margin-left: auto; padding-left: 0; padding-right: 0">
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<blockquote style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 9px 18px; font-size: inherit; border-left: 5px solid #eee; margin: 1em 2em"><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">This is part two (<a href="https://powershellone.wordpress.com/2021/03/03/graph-theory-with-powershell/" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">part one</a>) of graph theory, focussing on "Small World Graphs", with PowerShell based on (Chapter 3) of the execellent book <a href="https://greenteapress.com/wp/think-complexity-2e/" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Think Complexity 2e</a> by Allen B. Downey (in fact Iâ€™d highly recommend any of the books in the â€œThinkâ€¦â€� series some of which I might cover in future posts). The book and the bookâ€™s source (in Python) are available for free through the bookâ€™s webpage (the physical book can be purchased too).</p>
</blockquote>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<h1 id="Table-of-contents" style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: inherit; margin-bottom: 9px; font-size: 185.7%; margin: 1.08em 0 0 0; font-weight: bold; line-height: 1; margin-top: 0.538em'>Table of contents<a class="anchor-link" href="#Table-of-contents" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a></h1><ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0; margin-top: 1em">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">## <a href="#theory" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Some necessary theory</a></li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">## <a href="#ring" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Ring-Lattice graph</a></li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">## <a href="#smallworld" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Small-World graph Watts/Strogatz</a><ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-bottom: 0; padding-left: 0; margin-top: 1em; list-style: circle; margin: 0 2em">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">### <a href="#clustering" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Clustering Coefficient</a></li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">### <a href="#shortest" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Shortest Path Length</a></li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">### <a href="#wse" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Small-World experiment (Watts, Strogatz)</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<h2 id="Some-necessary-theory-" style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: inherit; margin-bottom: 9px; font-size: 157.1%; margin: 1.27em 0 0 0; font-weight: bold; line-height: 1; margin-top: 0.636em'>Some necessary theory <a name="theory" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a><a class="anchor-link" href="#Some-necessary-theory-" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a></h2><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left; margin-top: 1em">Small World Graphs are graphs in which most nodes are not neighbors of one another, but the neighbors of any given node are likely to be neighbors of each other and most nodes can be reached from every other node by a small number of hops or steps.</p>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Most people have heard of Small World Graphs in conjunction with the <a href="https://en.wikipedia.org/wiki/Small-world_experiment" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">small-world expirement</a> conducted by <a href="https://en.wikipedia.org/wiki/Stanley_Milgram" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Stanley Milgram</a> leading to the infamous phrase "six degress of separation".</p>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">We will try to replicate the expirement based on <a href="https://en.wikipedia.org/wiki/Watts%E2%80%93Strogatz_model" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">the work of Watts and Strogatz</a>. The Wattsâ€“Strogatz model is a random graph generation model (we talked about random graphs in <a href="https://powershellone.wordpress.com/2021/03/03/graph-theory-with-powershell/" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">part one</a> of this seeries) that produces graphs with small-world properties, including short average path lengths and high clustering, which neither regular graphs (see below) nor random graphs exhibit at the same time.</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><strong style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-weight: bold">Clustering</strong> is a measure of the degree to which nodes in a graph tend to group together. Evidence suggests that in most real-world networks, and in particular social networks, nodes tend to create tightly knit clusters characterized by a relatively high density of ties; this likelihood tends to be greater than the average probability of a tie randomly established between two nodes.</p>
</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><strong style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-weight: bold">Average path length</strong> - The average number of edges between two nodes.</p>
</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><strong style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-weight: bold">Regular Graph</strong> -  A graph where each node has the same number of neighbors the number of neighbors is also called the degree of the node.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">The Watts and Strogatz model suggests the following steps to generate a Small World Graph:</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Start with a regular graph (a ring lattice graph can be used for this purpose) with n nodes and each node connected to k neighbors.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Choose a subset of the edges and â€œrewireâ€� them by replacing them with random edges.</li>
</ul>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">In a ring lattice graph the nodes are arranged in a circle with each node connected to the specified nearest neighbors.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<h2 id="Ring-Lattice-graph-" style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: inherit; margin-bottom: 9px; font-size: 157.1%; margin: 1.27em 0 0 0; font-weight: bold; line-height: 1; margin-top: 0.636em'>Ring-Lattice graph <a name="ring" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a><a class="anchor-link" href="#Ring-Lattice-graph-" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a></h2><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left; margin-top: 1em">Enough theory let's use some code. First we'll need some of the helper functions created in the <a href="https://powershellone.wordpress.com/2021/03/03/graph-theory-with-powershell/" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">first part</a>.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Import-Module</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">PSGraph</span>

<span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Show-PSGraph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">([</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">ValidateSet</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'dot'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circular'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'Hierarchical'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'Radial'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'fdp'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'neato'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'sfdp'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'SpringModelLarge'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'SpringModelSmall'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'SpringModelMedium'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'twopi'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">LayoutEngine</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'circular'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">all</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Input</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">tempPath</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[System.IO.Path]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">GetTempFileName</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">all</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Out-File</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">tempPath</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">new</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Content</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">tempPath</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-raw</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">ForEach</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Object</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-replace</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"</span><span class="se" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #B62; font-weight: bold">`r</span><span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">"</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="s2" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">""</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">new</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Set-Content</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-NoNewline</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">tempPath</span>
    <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Export-PSGraph</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Source</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">tempPath</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-ShowGraph</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-LayoutEngine</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">LayoutEngine</span>
    <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Invoke-Item</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">tempPath</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'.png'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Remove-Item</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">tempPath</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>

<span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">New-Edge</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Attributes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[switch]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">AsObject</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">null</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">PSBoundParameters</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Remove</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'AsObject'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[Hashtable]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">PSBoundParameters</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">AsObject</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">return</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[PSCustomObject]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">return</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>


<span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Neighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Name</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[switch]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Undirected</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edgeObjects</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(@($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)[</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">].</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">GetType</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">().</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">FullName</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-ne</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'System.Management.Automation.PSCustomObject'</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edgeObjects</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
            <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[PSCustomObject]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(&amp;</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edgeObjects</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-eq</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Name</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span>
            <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Undirected</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edgeObjects</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-eq</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Name</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">!</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[String]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IsNullOrEmpty</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>

<span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-LogSpace</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[Double]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Minimum</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[Double]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Maximum</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Count</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">increment</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Maximum</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Minimum</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">/</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Count</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">for</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-lt</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Count</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">++</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[Math]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Pow</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">10</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Minimum</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">increment</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">*</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">))</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">We create a helper function to generate a Ring-Lattice graph.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-RingLattice</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">NumConnections</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[ordered]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@{}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">cons</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[int]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">NumConnections</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">/</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">len</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Count</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">for</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-le</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">cons</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">);$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">++){</span>
            <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">New-Edge</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">%</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">len</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)]</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-AsObject</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Visual</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">inline</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'edge [arrowsize=0]'</span>
        <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-FromScript</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-ToScript</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[PSCustomObject]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ht</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; position: relative; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; z-index: 1">
<div class="output" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch">
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_html rendered_html output_subarea" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #000; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex)">
<div style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">
<div id="dotnet-interactive-this-cell-394.Microsoft.DotNet.Interactive.Http.HttpPort" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; display: none">
        The below script needs to be able to find the current output cell; this is an easy method to get it.
    </div>
<script style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box" type="text/javascript">
async function probeAddresses(probingAddresses) {
    function timeout(ms, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'))
            }, ms)
            promise.then(resolve, reject)
        })
    }

    if (Array.isArray(probingAddresses)) {
        for (let i = 0; i < probingAddresses.length; i++) {

            let rootUrl = probingAddresses[i];

            if (!rootUrl.endsWith('/')) {
                rootUrl = `${rootUrl}/`;
            }

            try {
                let response = await timeout(1000, fetch(`${rootUrl}discovery`, {
                    method: 'POST',
                    cache: 'no-cache',
                    mode: 'cors',
                    timeout: 1000,
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: probingAddresses[i]
                }));

                if (response.status == 200) {
                    return rootUrl;
                }
            }
            catch (e) { }
        }
    }
}

function loadDotnetInteractiveApi() {
    probeAddresses(["http://10.0.47.173:1025/", "http://127.0.0.1:1025/"])
        .then((root) => {
        // use probing to find host url and api resources
        // load interactive helpers and language services
        let dotnetInteractiveRequire = require.config({
        context: '394.Microsoft.DotNet.Interactive.Http.HttpPort',
                paths:
            {
                'dotnet-interactive': `${root}resources`
                }
        }) || require;

            window.dotnetInteractiveRequire = dotnetInteractiveRequire;

            window.configureRequireFromExtension = function(extensionName, extensionCacheBuster) {
                let paths = {};
                paths[extensionName] = `${root}extensions/${extensionName}/resources/`;
                
                let internalRequire = require.config({
                    context: extensionCacheBuster,
                    paths: paths,
                    urlArgs: `cacheBuster=${extensionCacheBuster}`
                    }) || require;

                return internalRequire
            };
        
            dotnetInteractiveRequire([
                    'dotnet-interactive/dotnet-interactive'
                ],
                function (dotnet) {
                    dotnet.init(window);
                },
                function (error) {
                    console.log(error);
                }
            );
        })
        .catch(error => {console.log(error);});
    }

// ensure `require` is available globally
if ((typeof(require) !==  typeof(Function)) || (typeof(require.config) !== typeof(Function))) {
    let require_script = document.createElement('script');
    require_script.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js');
    require_script.setAttribute('type', 'text/javascript');
    
    
    require_script.onload = function() {
        loadDotnetInteractiveApi();
    };

    document.getElementsByTagName('head')[0].appendChild(require_script);
}
else {
    loadDotnetInteractiveApi();
}

    </script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Let's create a Ring-Lattice graph with 10 nodes and 4 connections per node.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ringLattice</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-RingLattice</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">9</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">4</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ringLattice</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Visual</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Show-PSGraph</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><img alt="image.png" src="https://powershellone.files.wordpress.com/2021/03/img0.png" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 0; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<h2 id="Small-World-Graphs-(Watts-Strogatz)-" style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: inherit; margin-bottom: 9px; font-size: 157.1%; margin: 1.27em 0 0 0; font-weight: bold; line-height: 1; margin-top: 0.636em'>Small-World Graphs (Watts-Strogatz) <a name="smallworld" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a><a class="anchor-link" href="#Small-World-Graphs-(Watts-Strogatz)-" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a></h2><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left; margin-top: 1em">To turn our Ring-Lattice graph into a small-world graph we need to "re-wire" the nodes. The algorithm for the re-wiring should follow this logic:</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Iterate over all edges and rewire them based on a specified probability.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">If and edge is chosen to be rewired<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 0; padding-left: 0; list-style: circle; margin: 0 2em">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Leave the .From part of the edge as is.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Rewire the .To part of the edge to any random node, but...<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 0; padding-left: 0; list-style: circle; margin: 0 2em">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">The current .From and To. nodes</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Any neighbours of the .From node</li>
</ul>
</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Replace the current edge with the old .From and the new .To pair</li>
</ul>
</li>
</ul>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">We can re-use of the Get-Neighbours function from my previous post.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-SmallWorldGraph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">NumConnections</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Probability</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-RingLattice</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">NumConnections</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Clone</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">()</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rand</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Random</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Minimum</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Maximum</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">10000</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">/</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">10000</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">rand</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-le</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Probability</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">fromNeighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Neighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Undirected</span>
            <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#need to use foreach construct to expand nexted array of fromNeighbours</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">exclude</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">fromNeighbours</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">})</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">toConnect</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-notin</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">exclude</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">})}</span>
            <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#remove the current edge</span>
            <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#see https://en.wikipedia.org/wiki/De_Morgan%27s_laws</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-ne</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-or</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-ne</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
            <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#add the new edge += for "adding to an array is bad but good enough in this case</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">New-Edge</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Random</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-InputObject</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">toConnect</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-AsObject</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#redo the visual part based on the new edges</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Visual</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">inline</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'edge [arrowsize=0]'</span>
        <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">edge</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-FromScript</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-ToScript</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; position: relative; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; z-index: 1">
<div class="output" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch">
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_html rendered_html output_subarea" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #000; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex)">
<div style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">
<div id="dotnet-interactive-this-cell-115.Microsoft.DotNet.Interactive.Http.HttpPort" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; display: none">
        The below script needs to be able to find the current output cell; this is an easy method to get it.
    </div>
<script style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box" type="text/javascript">
async function probeAddresses(probingAddresses) {
    function timeout(ms, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'))
            }, ms)
            promise.then(resolve, reject)
        })
    }

    if (Array.isArray(probingAddresses)) {
        for (let i = 0; i < probingAddresses.length; i++) {

            let rootUrl = probingAddresses[i];

            if (!rootUrl.endsWith('/')) {
                rootUrl = `${rootUrl}/`;
            }

            try {
                let response = await timeout(1000, fetch(`${rootUrl}discovery`, {
                    method: 'POST',
                    cache: 'no-cache',
                    mode: 'cors',
                    timeout: 1000,
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: probingAddresses[i]
                }));

                if (response.status == 200) {
                    return rootUrl;
                }
            }
            catch (e) { }
        }
    }
}

function loadDotnetInteractiveApi() {
    probeAddresses(["http://10.0.17.68:1025/", "http://127.0.0.1:1025/"])
        .then((root) => {
        // use probing to find host url and api resources
        // load interactive helpers and language services
        let dotnetInteractiveRequire = require.config({
        context: '115.Microsoft.DotNet.Interactive.Http.HttpPort',
                paths:
            {
                'dotnet-interactive': `${root}resources`
                }
        }) || require;

            window.dotnetInteractiveRequire = dotnetInteractiveRequire;

            window.configureRequireFromExtension = function(extensionName, extensionCacheBuster) {
                let paths = {};
                paths[extensionName] = `${root}extensions/${extensionName}/resources/`;
                
                let internalRequire = require.config({
                    context: extensionCacheBuster,
                    paths: paths,
                    urlArgs: `cacheBuster=${extensionCacheBuster}`
                    }) || require;

                return internalRequire
            };
        
            dotnetInteractiveRequire([
                    'dotnet-interactive/dotnet-interactive'
                ],
                function (dotnet) {
                    dotnet.init(window);
                },
                function (error) {
                    console.log(error);
                }
            );
        })
        .catch(error => {console.log(error);});
    }

// ensure `require` is available globally
if ((typeof(require) !==  typeof(Function)) || (typeof(require.config) !== typeof(Function))) {
    let require_script = document.createElement('script');
    require_script.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js');
    require_script.setAttribute('type', 'text/javascript');
    
    
    require_script.onload = function() {
        loadDotnetInteractiveApi();
    };

    document.getElementsByTagName('head')[0].appendChild(require_script);
}
else {
    loadDotnetInteractiveApi();
}

    </script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Below are three Small World graphs with the following properties:</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">20 nodes</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">4 connections per node</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Probabilities of 10%, 30%, and 80%</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">prob</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">8</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)){</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">swGraph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-SmallWorldGraph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">19</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">4</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">prob</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">swGraph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Visual</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Show-PSGraph</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><img alt="image.png" src="https://powershellone.files.wordpress.com/2021/03/img1.png" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 0; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">As a next step we need to develop methods that helps us to evaluate the clustering and path-length properties of the produced graphs.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<h3 id="Clustering-Coefficient-" style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: inherit; margin-bottom: 9px; font-size: 128.6%; margin: 1.55em 0 0 0; font-weight: bold; line-height: 1; margin-top: 0.777em'>Clustering Coefficient <a name="clustering" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a><a class="anchor-link" href="#Clustering-Coefficient-" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a></h3><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left; margin-top: 1em">A cluster can be defined as a set of nodes with edges between all pairs of nodes in the set. The clustering coefficient for a node is given by the proportion of actual links between the nodes within its neighbourhood divided by the number of links that could possibly exist between them. If we iterate over every node of a graph and calculate this proportion and take the average of those, we are getting the <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">clusteirng coefficient</code> for the graph.
The number of unique connections between a set of n nodes can be calculated with the formula <del style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">\frac{n(n-1)}{2}</del>.
If you imagine a room with n people, where you want to determine the number of unique pairs:</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">The first person can pair up with everyone except themselves n-1..</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">...so can everyone else n*(n-1). </li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Since n represents the number of people rather than pairs the result needs to be divided by 2 <del style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">\frac{n(n-1)}{2}</del>.</li>
</ul>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">Below is the implementation of the clustering coefficient algorithm.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-ClusteringCoefficient</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">individualCEs</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Neighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Undirected</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">numNeighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbours</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Count</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#CE undefined skip to next node</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">numNeighbours</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-lt</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span> 
            <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[Single]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">NaN</span> 
            <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">continue</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">possibleConnections</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">numNeighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">*</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">numNeighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">/</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">2</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">nodes</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">actualConnections</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">for</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-lt</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">numNeighBours</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">++)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
            <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">for</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">j</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">j</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-lt</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbours</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Count</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">j</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">++)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
                <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-lt</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">j</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
                    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">l</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbours</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span>
                    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">r </span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbours</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">j</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span>
                    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#the way the edge objects are setup currently we will need to check for both sides</span>
                    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#would be better to setup sundirected edges differently</span>
                    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-eq</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">l</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-and</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-eq</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">r</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-or</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-eq</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">r </span><span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-and</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">To</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-eq</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">l</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>   
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">actualConnections</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Count</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">/$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">possibleConnections</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic">#return the average of the clustering coefficients per node exlcuding NaNs</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">individualCEs</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span><span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-not</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[Single]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">IsNaN</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">))</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; position: relative; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; z-index: 1">
<div class="output" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch">
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_html rendered_html output_subarea" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #000; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex)">
<div style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">
<div id="dotnet-interactive-this-cell-118.Microsoft.DotNet.Interactive.Http.HttpPort" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; display: none">
        The below script needs to be able to find the current output cell; this is an easy method to get it.
    </div>
<script style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box" type="text/javascript">
async function probeAddresses(probingAddresses) {
    function timeout(ms, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'))
            }, ms)
            promise.then(resolve, reject)
        })
    }

    if (Array.isArray(probingAddresses)) {
        for (let i = 0; i < probingAddresses.length; i++) {

            let rootUrl = probingAddresses[i];

            if (!rootUrl.endsWith('/')) {
                rootUrl = `${rootUrl}/`;
            }

            try {
                let response = await timeout(1000, fetch(`${rootUrl}discovery`, {
                    method: 'POST',
                    cache: 'no-cache',
                    mode: 'cors',
                    timeout: 1000,
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: probingAddresses[i]
                }));

                if (response.status == 200) {
                    return rootUrl;
                }
            }
            catch (e) { }
        }
    }
}

function loadDotnetInteractiveApi() {
    probeAddresses(["http://10.0.48.149:1025/", "http://127.0.0.1:1025/"])
        .then((root) => {
        // use probing to find host url and api resources
        // load interactive helpers and language services
        let dotnetInteractiveRequire = require.config({
        context: '118.Microsoft.DotNet.Interactive.Http.HttpPort',
                paths:
            {
                'dotnet-interactive': `${root}resources`
                }
        }) || require;

            window.dotnetInteractiveRequire = dotnetInteractiveRequire;

            window.configureRequireFromExtension = function(extensionName, extensionCacheBuster) {
                let paths = {};
                paths[extensionName] = `${root}extensions/${extensionName}/resources/`;
                
                let internalRequire = require.config({
                    context: extensionCacheBuster,
                    paths: paths,
                    urlArgs: `cacheBuster=${extensionCacheBuster}`
                    }) || require;

                return internalRequire
            };
        
            dotnetInteractiveRequire([
                    'dotnet-interactive/dotnet-interactive'
                ],
                function (dotnet) {
                    dotnet.init(window);
                },
                function (error) {
                    console.log(error);
                }
            );
        })
        .catch(error => {console.log(error);});
    }

// ensure `require` is available globally
if ((typeof(require) !==  typeof(Function)) || (typeof(require.config) !== typeof(Function))) {
    let require_script = document.createElement('script');
    require_script.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js');
    require_script.setAttribute('type', 'text/javascript');
    
    
    require_script.onload = function() {
        loadDotnetInteractiveApi();
    };

    document.getElementsByTagName('head')[0].appendChild(require_script);
}
else {
    loadDotnetInteractiveApi();
}

    </script>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">If we test with our Ring-Lattice graph from our, we can get the expected .5 (each nodes has 4 neighbours with 3 connections out of possible 6 connections)</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-ClusteringCoefficient</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ringLattice</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; position: relative; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; z-index: 1">
<div class="output" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch">
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_subarea output_stream output_stdout output_text" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex); text-align: left; color: #000; line-height: 1.21429em">
<pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; font-size: inherit; line-height: inherit; white-space: pre; margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0">0.5
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<h3 id="Shortest-Path-Length-" style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: inherit; margin-bottom: 9px; font-size: 128.6%; margin: 1.55em 0 0 0; font-weight: bold; line-height: 1; margin-top: 0.777em'>Shortest Path Length <a name="shortest" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a><a class="anchor-link" href="#Shortest-Path-Length-" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">The next step is to calculate the shortest path length, which is the average length of the shortest path between each pair of nodes.</p>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">There are several well-known algorithms to do this one of them is the <a href="https://en.wikipedia.org/wiki/Bellman%E2%80%93Ford_algorithm" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Bellmann-Ford algorithm</a>. Fortunately, PowerShell MVP <a href="https://twitter.com/dfinke?lang=en" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">Doug Finke</a> was already kind enough to implement the algorithm in PowerShell (see <a href="https://github.com/dfinke/powershell-algorithms/tree/master/src/algorithms/graph/bellman-ford" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">here</a>. Below is my version based on Doug's implementation.</p>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">At a high level, the algorithm works like this:</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Based on a graph object and a given starting node:</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">For each node in the graph iterate over each of the node's neighbours.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Keep track of the distances by just adding 1 for the respective pair.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Add the path length to the pair in case it's shorter than the current distance saved for the pair.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-ShortestPath</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">StartNode</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@{}</span>
    
    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic"># Init all distances with infinity assuming that currently we can't reach</span>
    <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic"># any of the nodes except start one.</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">startNode</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-ne</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">StartNode</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[double]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">PositiveInfinity</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">for</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">;</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-lt</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">count</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">);</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">i</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">++){</span>
        <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic"># During each iteration go through all nodes</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">nodes</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Clone</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">().</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Keys</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">nodes</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Neighbours</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Undirected</span>
            <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbour</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbours</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic"># Find out if the distance to the neighbour is shorter in this iteration</span>
                <span class="c" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #408080; font-style: italic"># than in previous one.</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distanceToNode</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">node</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distanceToNeighbour</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distanceToNode</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">1</span>
                <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">if</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distanceToNeighbour</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-lt</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbour</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">])</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
                    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">[$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">neighbour</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">]</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distanceToNeighbour</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>

    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">GetEnumerator</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">().</span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[PSCustomObject][ordered]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@{</span>
            <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Source</span>      <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">startNode</span>
            <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Destination</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Name</span>
            <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Distance</span>    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Value</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">The function returns an object array with Source, Distance, and Destination properties. If we use it on the first node of a our previously created Ring-Lattice graph (added here again for convenience), we get the following result:</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><img alt="image.png" src="https://powershellone.files.wordpress.com/2021/03/img2.png" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 0; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto"></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-ShortestPath</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ringLattice</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; position: relative; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; z-index: 1">
<div class="output" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch">
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_html rendered_html output_subarea" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #000; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex)">
<div style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">
<div id="dotnet-interactive-this-cell-857.Microsoft.DotNet.Interactive.Http.HttpPort" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; display: none">
        The below script needs to be able to find the current output cell; this is an easy method to get it.
    </div>
<script style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box" type="text/javascript">
async function probeAddresses(probingAddresses) {
    function timeout(ms, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'))
            }, ms)
            promise.then(resolve, reject)
        })
    }

    if (Array.isArray(probingAddresses)) {
        for (let i = 0; i < probingAddresses.length; i++) {

            let rootUrl = probingAddresses[i];

            if (!rootUrl.endsWith('/')) {
                rootUrl = `${rootUrl}/`;
            }

            try {
                let response = await timeout(1000, fetch(`${rootUrl}discovery`, {
                    method: 'POST',
                    cache: 'no-cache',
                    mode: 'cors',
                    timeout: 1000,
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: probingAddresses[i]
                }));

                if (response.status == 200) {
                    return rootUrl;
                }
            }
            catch (e) { }
        }
    }
}

function loadDotnetInteractiveApi() {
    probeAddresses(["http://10.0.52.123:1024/", "http://127.0.0.1:1024/"])
        .then((root) => {
        // use probing to find host url and api resources
        // load interactive helpers and language services
        let dotnetInteractiveRequire = require.config({
        context: '857.Microsoft.DotNet.Interactive.Http.HttpPort',
                paths:
            {
                'dotnet-interactive': `${root}resources`
                }
        }) || require;

            window.dotnetInteractiveRequire = dotnetInteractiveRequire;

            window.configureRequireFromExtension = function(extensionName, extensionCacheBuster) {
                let paths = {};
                paths[extensionName] = `${root}extensions/${extensionName}/resources/`;
                
                let internalRequire = require.config({
                    context: extensionCacheBuster,
                    paths: paths,
                    urlArgs: `cacheBuster=${extensionCacheBuster}`
                    }) || require;

                return internalRequire
            };
        
            dotnetInteractiveRequire([
                    'dotnet-interactive/dotnet-interactive'
                ],
                function (dotnet) {
                    dotnet.init(window);
                },
                function (error) {
                    console.log(error);
                }
            );
        })
        .catch(error => {console.log(error);});
    }

// ensure `require` is available globally
if ((typeof(require) !==  typeof(Function)) || (typeof(require.config) !== typeof(Function))) {
    let require_script = document.createElement('script');
    require_script.setAttribute('src', 'https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js');
    require_script.setAttribute('type', 'text/javascript');
    
    
    require_script.onload = function() {
        loadDotnetInteractiveApi();
    };

    document.getElementsByTagName('head')[0].appendChild(require_script);
}
else {
    loadDotnetInteractiveApi();
}

    </script>
</div>
</div>
</div>
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_subarea output_stream output_stdout output_text" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex); text-align: left; color: #000; line-height: 1.21429em">
<pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; font-size: inherit; line-height: inherit; white-space: pre; margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0">
Source Destination Distance
------ ----------- --------
0      9           1
0      8           1
0      7           2
0      6           2
0      5           3
0      4           2
0      3           2
0      2           1
0      1           1
0      0           0

</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">To get the average shortest path length for a whole graph we need to ... :</p>
<ul style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin-top: 0; margin-bottom: 9px; list-style: disc; margin: 0 2em; padding-left: 0">
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">... do this for every unique starting point (From) in the graph.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Remove the infinity (for pairs that don't have a connection) and 0 (from node to self) Distance entries.</li>
<li style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Get the average of the remaining distances.</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">groupedEdges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ringLattice</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">group </span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">group </span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">groupedEdges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
    <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-ShortestPath</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ringLattice</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">group</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Name</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Distance</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-ne</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-and</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Distance</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-ne</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[double]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">PositiveInfinity</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span>
    <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Measure-Object</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Property</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Distance</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Average</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Average</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; position: relative; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; z-index: 1">
<div class="output" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch">
<div class="output_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 0; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="output_subarea output_stream output_stdout output_text" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow-x: auto; padding: 0.4em; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1; max-width: calc(100% - 14ex); text-align: left; color: #000; line-height: 1.21429em">
<pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; font-size: inherit; line-height: inherit; white-space: pre; margin: 0; padding: 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0">1.66666666666667
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<h3 id="Small-World-experiment-(Watts,-Strogatz)-" style='-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; color: inherit; margin-bottom: 9px; font-size: 128.6%; margin: 1.55em 0 0 0; font-weight: bold; line-height: 1; margin-top: 0.777em'>Small-World experiment (Watts, Strogatz) <a name="wse" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a><a class="anchor-link" href="#Small-World-experiment-(Watts,-Strogatz)-" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none"></a></h3><p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left; margin-top: 1em">Great, now we have everything in place to do duplicate the Small-world expirement. Showing that there are Small-Word graphs with a certain range of probability (for re-wiring) with high clustering-coefficients (like regular graphs) and a short average path lengths (like in random graphs).</p>
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">In practice it turned out that, at least with the haphazardly version of my code, the PowerShell functions are not executing nearly fast enough to carry out the experiment with 1000 nodes for each graph and 10 connections each. Even though I have added multi-threading to the Shortest-Path parts using <a href="https://www.powershellgallery.com/packages/ThreadJob/2.0.3" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background-color: transparent; color: #337ab7; text-decoration: none">PSThreadJobs's</a> <code style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; font-family: monospace; border-radius: 2px; white-space: pre; border: 0; background-color: #fff; color: #000; font-size: 100%; padding: 0">Start-ThreadJob</code> function, since this is definitely the bottleneck.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered" style="-webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%)">
<div class="input" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; page-break-inside: avoid; -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch">

<div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="input_area" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em">
<div class="highlight hl-powershell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; background: #f8f8f8; margin: 0; border: none; padding: 0; background-color: transparent"><pre style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto; font-family: monospace; display: block; word-break: break-all; word-wrap: break-word; color: #333; border-radius: 2px; font-size: inherit; line-height: inherit; white-space: pre; margin: 5pt; border: none; padding: 0; background-color: transparent"><span style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box"></span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">function</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Do</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Experiment</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">..</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">20</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">),</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">NumConnections</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">3</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">,</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Probabilities</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
    <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">probability</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Probabilities</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">apl</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[System.Collections.ArrayList]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@()</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ccoe</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[System.Collections.ArrayList]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@()</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">jobs</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@()</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-SmallWorldGraph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Nodes</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">NumConnections</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">probability</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">groupedEdges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Edges</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">group </span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">From</span>
        <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">foreach</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">group </span><span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">in</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">groupedEdges</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">){</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">initBlock</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[ScriptBlock]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Create</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span>
            <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'function Get-ShortestPath{'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Command</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-ShortestPath</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Definition</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'}'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span>
            <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'function Get-Neighbours{'</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Command</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-Neighbours</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Definition</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+</span> <span class="s1" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #BA2121">'}'</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">jobs</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">+=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Start-ThreadJob</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-InitializationScript</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">initBlock</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{</span>
                <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">group </span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">group</span>
                <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-ShortestPath</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">using</span><span class="err" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 1px solid #F00">:</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">group</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Name</span>
            <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">null</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">jobs</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Wait-Job</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">jobs</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Receive-Job</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">null</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">jobs</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Remove-Job</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">null</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">apl</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Add</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">(($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">distances</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">where</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">{$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Distance</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-ne</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-and</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">_</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Distance</span> <span class="o" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #666">-ne</span> <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[double]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">::</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">PositiveInfinity</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span>
            <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Measure-Object</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Property</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Distance</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Average</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Average</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">)</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">null</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ccoe</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">.</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Add</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">((</span><span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-ClusteringCoefficient</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">graph</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">))</span>
        
        <span class="no" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #800">[PSCustomObject][ordered]</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">@{</span>
            <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Probability</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">probability</span>
            <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">AveragePathLength</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">apl</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Measure-Object</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Average</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Average</span>
            <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ClusteringCoeeficient</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">($</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">ccoe</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">|</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Measure-Object</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Average</span><span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">).</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">Average</span>
        <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
    <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">}</span>

<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">probabilities</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="nb" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000">Get-LogSpace</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">4</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">0</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">9</span>
<span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">result</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">=</span> <span class="k" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; color: #008000; font-weight: bold">Do</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Experiment</span> <span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">-Probabilities</span> <span class="p" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">$</span><span class="n" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box">probabilities</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left">While this is unfortunate, I have definitely learned a lot along the way. We can take the results from the original Watts/Strogatz paper (L = average path length standardized, C = clustering coefficients standardizes) instead and appreciate that as the probability increases, the average path length decreases quite rapidly, because even a small number of randomly rewired edges provide shorter paths between nodes that are far apart. Replacing neighbouring links decreases the clustering coeï¬ƒcient much more slowly.
As a result, there is a wide range of probabilities with high clustering coeffeicients and low average path lengths.</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered" style="border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; margin: 0; outline: none; border-left-width: 1px; padding-left: 5px; background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%); -webkit-box-orient: horizontal; -webkit-box-align: stretch; -moz-box-orient: horizontal; -moz-box-align: stretch; box-orient: horizontal; box-align: stretch; display: flex; flex-direction: row; align-items: stretch"><div class="inner_cell" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; -moz-box-orient: vertical; -moz-box-align: stretch; box-orient: vertical; box-align: stretch; display: flex; flex-direction: column; align-items: stretch; -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; flex: 1">
<div class="text_cell_render border-box-sizing rendered_html" style="outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; overflow-x: auto; overflow-y: hidden">
<p style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; margin: 1em 0 9px; margin-bottom: 0; text-align: left"><img alt="image.png" src="https://powershellone.files.wordpress.com/2021/03/img3.png" style="-webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; border: 0; vertical-align: middle; display: block; margin-left: auto; margin-right: auto; max-width: 100%; height: auto"></p>
</div>
</div>
</div>
</div>
</div>
<p align="center" style="font-size: 12px; color: #9d9999;">Wordpress conversion from graphTheory2.ipynb by <a href="https://github.com/bennylp/nb2wp">nb2wp</a> v0.3.1</p>
</body>
</html>
